{% extends 'base.html' %}
{% block content %}
<div class="container my-5" style="max-width:900px;">

    <div style="margin-bottom:1.5rem; text-align:right;">
        <a href="{{ url_for('admin_add_product') }}" class="actions"
           style="background-color:#7D5BA6; color:white; padding:6px 12px; border-radius:5px; text-decoration:none; font-weight:600;">
           ➕ Add Product
        </a>
    </div>

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          <div class="flash-message {{ category }}"
               style="padding:10px 15px; border-radius:5px; margin-bottom:10px;
                      {% if category=='success' %}background-color:#C8E6C9; color:#256029;
                      {% elif category=='danger' %}background-color:#F8D7DA; color:#842029;
                      {% elif category=='warning' %}background-color:#FFF3CD; color:#664D03;{% endif %}">
            {{ message }}
          </div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    <table style="width:100%; border-collapse:collapse; background:white; border-radius:10px; overflow:hidden; box-shadow:0 4px 15px rgba(0,0,0,0.1);">
        <thead style="background-color:#EDE7F6; color:#4B0082;">
            <tr>
                <th style="padding:12px;">ID</th>
                <th style="padding:12px;">Name</th>
                <th style="padding:12px;">Price</th>
                <th style="padding:12px;">Description</th>
                <th style="padding:12px;">Image</th>
                <th style="padding:12px;">Actions</th>
            </tr>
        </thead>
        <tbody>
            {% if products %}
                {% for product in products %}
                    <tr style="border-bottom:1px solid #eee;">
                        <td style="padding:10px; text-align:center;">{{ product['id'] }}</td>
                        <td style="padding:10px;">{{ product['name'] }}</td>
                        <td style="padding:10px;">₱{{ '%.2f'|format(product['price']) }}</td>
                        <td style="padding:10px;">{{ product['desc'] }}</td>
                        <td style="padding:10px; text-align:center;">
                            <img src="{{ url_for('static', filename='images/' + product['image']) }}"
                                 alt="{{ product['name'] }}" style="width:60px; height:auto; border-radius:5px;">
                        </td>
                        <td style="padding:10px; text-align:center;">
                            <a href="{{ url_for('admin_edit_product', product_id=product['id']) }}"
                               style="color:white; background-color:#7D5BA6; padding:6px 10px; border-radius:5px; text-decoration:none; font-weight:600; margin-right:5px;">
                               Edit
                            </a>
                            <form action="{{ url_for('admin_delete_product', product_id=product['id']) }}" method="POST" style="display:inline-block;">
                                <button type="submit" onclick="return confirm('Are you sure you want to delete this product?')"
                                        style="background-color:#B00020; color:white; padding:6px 10px; border:none; border-radius:5px; cursor:pointer; font-weight:600;">
                                        Delete
                                </button>
                            </form>
                        </td>
                    </tr>
                {% endfor %}
            {% else %}
                <tr>
                    <td colspan="6" style="text-align:center; padding:15px;">No products found.</td>
                </tr>
            {% endif %}
        </tbody>
    </table>

    <a href="{{ url_for('admin_dashboard') }}" class="back-link"
       style="display:inline-block; margin-top:15px; text-decoration:none; color:#7D5BA6; font-weight:600;">⬅ Back to Dashboard</a>

</div>

<style>
body {
    font-family: 'Poppins', sans-serif;
    background-color: #f4f4f4;
}

.flash-message {
    margin-bottom: 1rem;
    padding: 10px 15px;
    border-radius: 5px;
}

.success { background-color: #C8E6C9; color: #256029; }
.danger { background-color: #F8D7DA; color: #842029; }
.warning { background-color: #FFF3CD; color: #664D03; }
</style>
{% endblock %}
